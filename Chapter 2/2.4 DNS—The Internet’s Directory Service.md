
###### Hostnames and IP addresses
* One identifier for an Internet host is its hostname, such as www.google.com, gaia.cs.umass.edu, www.wikipedia.org etc.
* Hostnames are mnemonic and are therefore appreciated by humans.
* However, hostnames provide little to no information about the location within the Internet of the host.
* Further, as hostnames can consist of variable-length alphanumeric characters, they would be difficult to process by routers.
* Hence, hosts are also identified by IP addresses (IPv4 and IPv6 addresses).
	* An IPv4 address consists of four bytes and has a rigid hierarchical structure.
 	* An IPv4 address looks like 121.7.106.83, where each period separates one of the bytes expressed in decimal notation from 0 to 255.
  	* An IP address is hierarchical because as we scan the address from left to right, we obtain more and more specific information about where the host is located in the Internet (that is, within which network, in the network of networks).

***

### 1. Services Provided by DNS

* The main task of the Internet’s domain name system (DNS) is to reconcile between humans-preferred hostnames and routers-preferred IP addresses.
* The DNS is:
	* A distributed database implemented in a hierarchy of DNS servers,
 	* An application-layer protocol that allows hosts to query the distributed database. 
* The DNS servers are often UNIX machines running the Berkeley Internet Name Domain (BIND) software.
* The DNS protocol usaully runs over UDP (and sometimes over TCP), and uses port 53.

###### Translating Hostnames to IP address
* DNS is commonly employed by other application-layer protocols, including HTTP and SMTP, to translate user-supplied hostnames to IP addresses.
* Following example illustrates the process of an HTML application calling DNS for IP resolution:
	* The browser (that is, an HTTP client), running on some user’s host, requests the URL.
 	* The same user machine runs the client side of the DNS application.
  	* The browser extracts the hostname from the URL and passes the hostname to the client side of the DNS application.
  	* The DNS client sends a query containing the hostname to a DNS server.
  	* The DNS client eventually receives a reply, which includes the IP address for the hostname.
  	* Once the browser receives the IP address from DNS, it can initiate a TCP connection to the HTTP/HTTPS server process located at port 80/443 at that IP address.
* Refer to [DNS - IP Lookup](https://github.com/violet-autumn/Computer-Networking/blob/main/Chapter%202/Additional%20texts.md#dns---ip-address-lookup) for a small exercise on DNS resolution.
* As we can see from the above example, DNS adds an additional delay to the Internet applications that use it.
* Fortunately, the desired IP address is often cached in a “nearby” DNS server, which helps to reduce DNS network traffic as well as the average DNS delay.

###### Host aliasing
* A host with a complicated hostname can have one or more alias names.
* For example, a hostname such as `relay1.west-coast.enterprise.com` could have, say, two aliases such as `enterprise.com` and `www.enterprise.com`.
* In this case, the hostname `relay1.west-coast.enterprise.com` is said to be a canonical hostname.
* Alias hostnames, when present, are typically more mnemonic than canonical hostnames.
* DNS can be invoked by an application to obtain the canonical hostname for a supplied alias hostname as well as the IP address of the host.

###### Mail server aliasing
* DNS can be invoked by a mail application to obtain the canonical hostname for a supplied alias hostname as well as the IP address of the host.
* In fact, the MX record permits a company’s mail server and Web server to have identical (aliased) hostnames; for example, a company’s Web server and mail server can both be called `enterprise.com`.

###### Load distribution
* DNS is also used to perform load distribution among replicated servers.
* Busy sites are often replicated over multiple servers, with each server running on a different end system and each having a different IP address.
* For replicated Web servers, a set of IP addresses is thus associated with one alias hostname.
* The DNS database contains this set of IP addresses.
* When clients make a DNS query for a name mapped to a set of addresses, the server responds with the entire set of IP addresses, but rotates the ordering of the addresses within each reply.
* As a client typically sends its HTTP request message to the IP address that is listed first in the set, DNS rotation distributes the traffic among the replicated servers.
* DNS rotation is also used for e-mail so that multiple mail servers can have the same alias name.
* Content distribution companies such as Akamai have used DNS in more sophisticated ways to provide Web content distribution.

***

### 2. Overview of How DNS Works

###### Drawbacks of a centralised DNS design
* In a centralized design, clients simply direct all queries to the single DNS server, and the DNS server responds directly to the querying clients.
* The problems with a centralized design include:
	* A single point of failure - If the DNS server crashes, so does the entire Internet!
 	* Traffic volume - A single DNS server would have to handle all DNS queries (for all the HTTP requests and e-mail messages).
  	* Distant centralized database - A single DNS server cannot be “close to” all the querying clients and will lead to significant delays for most clients.
  	* Maintenance - The single DNS server would have to keep records for all Internet hosts. Not only would this centralized database be huge, but it would have to be updated frequently to account for every new host.
* Therefore, a centralized database in a single DNS server doesn’t scale.
* Consequently, the DNS is distributed by design.

###### A Distributed, Hierarchical Database
* DNS uses a large number of servers, organized in a hierarchical fashion and distributed around the world.
* Consequently, no single DNS server has all of the mappings for all of the hosts in the Internet.
* There are three classes of DNS servers — Root DNS servers, Top-level domain (TLD) DNS servers, and Authoritative DNS servers—organized.
* Suppose a DNS client wants to determine the IP address for the hostname `www.amazon.com`
	* The client first contacts one of the root servers, which returns IP addresses for TLD servers for the top-level domain `com`.
 	* The client then contacts one of these TLD servers, which returns the IP address of an authoritative server for `amazon.com`.
  	* Finally, the client contacts one of the authoritative servers for `amazon.com`, which returns the IP address for the hostname `www.amazon.com`.

###### Root DNS servers
* There are more than 1000 root servers instances scattered all over the world.
* These root servers are copies of 13 different root servers, managed by 12 different organizations, and coordinated through the Internet Assigned Numbers Authority.
* The full list of root name servers, along with the organizations that manage them and their IP addresses can be found at the [linked address](https://www.iana.org/domains/root/servers).
* Root name servers provide the IP addresses of the TLD servers.

###### Top-level domain (TLD) servers
* For each of the top-level domains (top-level domains such as com, org, net, edu, and gov and all of the country top-level domains such as uk, fr, ca, in, and jp), there is TLD server (or server cluster).
* The company Verisign Global Registry Services maintains the TLD servers for the `com` top-level domain, while Educause maintains the TLD servers for the `edu` top-level domain.
* TLD servers provide the IP addresses for authoritative DNS servers.

###### Authoritative DNS servers
* Every organization with publicly accessible hosts (such as Web servers and mail servers) on the Internet must provide publicly accessible DNS records that map the names of those hosts to IP addresses.
* An organization’s authoritative DNS server houses these DNS records.
* An organization can choose to implement its own authoritative DNS server or pay to have these records stored in an authoritative DNS server of some service provider.
* Most universities and large companies implement and maintain their own primary and secondary (backup) authoritative DNS server.

###### Local DNS server (Recursive DNS resolvers)
* A local DNS server does not strictly belong to the hierarchy of servers but is nevertheless central to the DNS architecture.
* Each ISP - a residential ISP or an institutional ISP - has a local DNS server (also called a default name server).
* When a host connects to an ISP, the ISP provides the host with the IP addresses of one or more of its local DNS servers.
* Some companies also provide publically available recursive DNS resolver services like Google (`8.8.8.8`) and Cloudfare (`1.1.1.1`).
* When a host makes a DNS query, the query is sent to the local DNS server (or the recursive DNS resolver), which acts a proxy and forwards the query into the DNS server hierarchy.
* The snapshot below illustrates how the local DNS server queries the DNS hierarchy (it is recursive at the requesting host to local DNS server level, and iterative across the hierarchy).
* Note that 8 DNS messages are sent in this example in order to obtain teh mapping for a single hostname.
* Sometimes it can be 10 DNS messages as the TLD server often doesn't know the authoritative DNS server directly, but through an intermediate DNS server, which adds a couple of additional hops.
* In theory, a DNS query can be iterative or recursive.
* In practice, the queries typically follow the pattern below - recursive from the requesting host to the local DNS server, and iterative across the hierarchy.
<img width="800" alt="image" src="https://github.com/user-attachments/assets/af51b134-019b-4473-b204-fa2a3c35f371" />

###### DNS Caching
* DNS extensively exploits DNS caching in order to improve the delay performance and to reduce the number of DNS messages ricocheting around the Internet.
* In a query chain, when a DNS server receives a DNS reply (containing, for example, a mapping from a hostname to an IP address), it can cache the mapping in its local memory.
* If a hostname/IP address pair is cached in a DNS server and another query arrives to the DNS server for the same hostname, the DNS server can provide the desired IP address, even if it is not authoritative for the hostname.
* As hosts and mappings between hostnames and IP addresses are by no means permanent, DNS servers discard cached information after a period of time (often set to two days).
* A local DNS server can also cache the IP addresses of TLD servers, thereby allowing the local DNS server to bypass the root DNS servers in a query chain. In fact, because of caching, root servers are bypassed for all but a very small fraction of DNS queries.

***

### 3. DNS Records and Messages
